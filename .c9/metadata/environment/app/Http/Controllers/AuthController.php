{"filter":false,"title":"AuthController.php","tooltip":"/app/Http/Controllers/AuthController.php","undoManager":{"mark":18,"position":18,"stack":[[{"start":{"row":174,"column":0},"end":{"row":174,"column":1},"action":"insert","lines":["d"],"id":1}],[{"start":{"row":174,"column":0},"end":{"row":174,"column":1},"action":"remove","lines":["d"],"id":2},{"start":{"row":174,"column":0},"end":{"row":174,"column":1},"action":"insert","lines":["đ"]}],[{"start":{"row":174,"column":0},"end":{"row":174,"column":1},"action":"remove","lines":["đ"],"id":3}],[{"start":{"row":174,"column":0},"end":{"row":174,"column":1},"action":"insert","lines":["d"],"id":4},{"start":{"row":174,"column":1},"end":{"row":174,"column":2},"action":"insert","lines":["d"]}],[{"start":{"row":174,"column":1},"end":{"row":174,"column":2},"action":"remove","lines":["d"],"id":5},{"start":{"row":174,"column":0},"end":{"row":174,"column":1},"action":"remove","lines":["d"]}],[{"start":{"row":174,"column":0},"end":{"row":174,"column":1},"action":"insert","lines":["d"],"id":6},{"start":{"row":174,"column":1},"end":{"row":174,"column":2},"action":"insert","lines":["d"]}],[{"start":{"row":174,"column":2},"end":{"row":174,"column":4},"action":"insert","lines":["()"],"id":7}],[{"start":{"row":174,"column":3},"end":{"row":174,"column":5},"action":"insert","lines":["''"],"id":8}],[{"start":{"row":174,"column":4},"end":{"row":174,"column":5},"action":"insert","lines":["h"],"id":9},{"start":{"row":174,"column":5},"end":{"row":174,"column":6},"action":"insert","lines":["i"]}],[{"start":{"row":174,"column":8},"end":{"row":174,"column":9},"action":"insert","lines":[";"],"id":10}],[{"start":{"row":174,"column":4},"end":{"row":174,"column":6},"action":"remove","lines":["hi"],"id":11},{"start":{"row":174,"column":4},"end":{"row":174,"column":19},"action":"insert","lines":["env('APP_ENV') "]}],[{"start":{"row":174,"column":19},"end":{"row":174,"column":20},"action":"remove","lines":["'"],"id":12}],[{"start":{"row":174,"column":3},"end":{"row":174,"column":4},"action":"remove","lines":["'"],"id":13}],[{"start":{"row":170,"column":40},"end":{"row":171,"column":0},"action":"insert","lines":["",""],"id":14},{"start":{"row":171,"column":0},"end":{"row":171,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":171,"column":12},"end":{"row":171,"column":32},"action":"insert","lines":["dd(env('APP_ENV') );"],"id":15}],[{"start":{"row":171,"column":12},"end":{"row":171,"column":15},"action":"insert","lines":["// "],"id":16}],[{"start":{"row":175,"column":0},"end":{"row":175,"column":3},"action":"insert","lines":["// "],"id":17}],[{"start":{"row":177,"column":11},"end":{"row":180,"column":77},"action":"remove","lines":[" $response = new Response();","            $response->withCookie(Cookie::make('AWSELBAuthSessionCookie-0', null, -1));","            $response->withCookie(Cookie::make('AWSELBAuthSessionCookie-1', null, -1));","            $response->withCookie(Cookie::make('AWSALBAuthNonce', null, -1));"],"id":18},{"start":{"row":177,"column":11},"end":{"row":181,"column":0},"action":"insert","lines":["$response = new Response();","$response = $response->withCookie(Cookie::make('AWSELBAuthSessionCookie-0', null, -1));","$response = $response->withCookie(Cookie::make('AWSELBAuthSessionCookie-1', null, -1));","$response = $response->withCookie(Cookie::make('AWSALBAuthNonce', null, -1));",""]}],[{"start":{"row":162,"column":2},"end":{"row":188,"column":5},"action":"remove","lines":["  public function logout(Request $request)","    {","        $request->session()->invalidate();","        $clientId = env('COGNITO_CLIENT_ID');","        $logoutUrl = env('COGNITO_LOGOUT_URL');","        $logoutRedirectUri = env('COGNITO_LOGOUT_REDIRECT_URI');","        $requestUrl = \"{$logoutUrl}?client_id={$clientId}&redirect_uri={$logoutRedirectUri}\";","        // dd($requestUrl);","        if (env('APP_ENV') == 'local') {","            // dd(env('APP_ENV') );","            $response = Http::get($requestUrl);","            return redirect('/index');","        } else {","// dd(env('APP_ENV') );","            // Delete ALB cookies","           $response = new Response();","$response = $response->withCookie(Cookie::make('AWSELBAuthSessionCookie-0', null, -1));","$response = $response->withCookie(Cookie::make('AWSELBAuthSessionCookie-1', null, -1));","$response = $response->withCookie(Cookie::make('AWSALBAuthNonce', null, -1));","","","            // Call logout endpoint","            $response->setStatusCode(302);","            $response->header('Location', $requestUrl);","            return redirect('/index');","        }","    }"],"id":19},{"start":{"row":162,"column":2},"end":{"row":188,"column":5},"action":"insert","lines":["   public function logout(Request $request)","    {","        //config Logout endpoint","        $request->session()->invalidate();","        $clientId = env('COGNITO_CLIENT_ID');","        $logoutUrl = env('COGNITO_LOGOUT_URL');","        $logoutRedirectUri = env('COGNITO_LOGOUT_REDIRECT_URI');","        $requestUrl = \"{$logoutUrl}?client_id={$clientId}&logout_uri={$logoutRedirectUri}\";","       ","            // Delete ALB cookies","          $response = new Response();","$response = $response->withCookie(Cookie::make('AWSELBAuthSessionCookie-0', null, -1));","$response = $response->withCookie(Cookie::make('AWSELBAuthSessionCookie-1', null, -1));","$response = $response->withCookie(Cookie::make('AWSALBAuthNonce', null, -1));","","// Add cache control headers","$response = $response->header('Cache-Control', 'no-store, no-cache, must-revalidate');","$response = $response->header('Pragma', 'no-cache');","$response = $response->header('Expires', '0');","","// Call logout endpoint","$response->setStatusCode(302);","$response->header('Location', $requestUrl);","return $response;","","        ","    }"]}]]},"ace":{"folds":[],"scrolltop":2070,"scrollleft":0,"selection":{"start":{"row":124,"column":0},"end":{"row":124,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":137,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1686543699196,"hash":"6235fa4c855f7d23c637c9f55f1f86b59ff00154"}